#!/usr/bin/env bash
CTAGS=''
if [[ -x $(which ctags-exuberant) ]]; then
  CTAGS=$(which ctags-exuberant)
elif [[ -x $(which ctags)  ]]; then
  # if using osx, make sure port install py26-ctags is installed
  CTAGS=$(which ctags)
fi

if [[ -z "$CTAGS" ]]; then
  echo "ctags-exuberant or ctags cannot be found"
  exit;
fi

$CTAGS -f tags \
    -h ".php" \
    -R \
    --exclude="/(\.svn/|\.git/)/" \
    --exclude="*/cache/*" \
    --exclude="*/logs/*" \
    --exclude="*/*.phar" \
    --totals=yes \
    --tag-relative=yes \
    --PHP-kinds=+cfidv \
    --regex-PHP="/abstract class ([^ ]*)/\1/c/" \
    --regex-PHP="/interface ([^ ]*)/\1/c/" \
    --regex-PHP="/(public |static |abstract |protected |private )+function ([^ (]*)/\2/f/"
