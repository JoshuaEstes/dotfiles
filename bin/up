#!/usr/bin/env bash
# vim: set ft=sh
####
#
# First figure out what box it is and run the main dependency managers
#
if [ $(uname) == "Linux" ]; then
    if [ $(command -v apt-get) ]; then
        echo 'Running apt-get update and upgrade'
        sudo apt-get update
        sudo apt-get upgrade
    fi
else
    if [ $(command -v brew) ]; then
        echo 'Running brew update'
        brew update
        echo 'Running brew upgrade'
        brew upgrade
        echo 'Cleaning up after self'
        brew cleanup
        echo 'Running brew prune'
        brew prune
    fi
fi

###
#
# Python Stuff
#
if [ $(command -v pip3) ]; then
    echo "Upgrading pip"
    pip3 install --upgrade pip
fi

####
#
# Vim
#
if [ $(command -v vim) ]; then
    echo 'Updating Vundle bundles'
    vim +PluginUpdate +qall
fi
#### end vim ####

####
#
# PHP
#
if [ $(command -v composer.phar) ]; then
    echo 'Updating composer.phar'
    composer.phar selfupdate

    echo 'Updating composer global dependencies'
    composer.phar global update
fi

# Magento
if [ $(command -v n98-magerun.phar) ]; then
    echo "Updating magerun"
    n98-magerun.phar self-update
fi
#### end php ####

####
#
# Ruby
#
if [ $(command -v gem) ]; then
    echo "Updating gem version, administrator password required"
    sudo gem update --system
    echo "Running gem update, administrator password may be required"
    sudo gem update
    echo "Running gem cleanup, administrator password may be required"
    sudo gem cleanup
fi
#### end ruby ####

####
#
# Node
#
if [ $(command -v npm) ]; then
    echo "Updating npm, administrator password may be required"
    sudo npm update -g npm
fi
#### end node ####
